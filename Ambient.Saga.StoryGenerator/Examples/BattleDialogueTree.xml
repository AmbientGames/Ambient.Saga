<?xml version="1.0" encoding="utf-8"?>
<!--
    Example: Battle Dialogue Tree
    Dialogue nodes triggered during Lord Darkblade battle
-->
<DialogueTrees xmlns="Ambient.Domain"
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <DialogueTree RefName="DRAMATIC_BOSS_BATTLE" DisplayName="Lord Darkblade Battle Dialogue" StartNodeId="opening_taunt">

        <!-- Opening taunt (Turn 1) -->
        <Node NodeId="opening_taunt">
            <Text>You dare challenge ME? Prepare to meet your doom!</Text>
            <Action Type="ChangeStance" RefName="Offensive" />
        </Node>

        <!-- First blood (75% HP) -->
        <Node NodeId="first_blood">
            <Text>You've drawn first blood... but it changes nothing!</Text>
            <Text>I've faced far greater warriors than you!</Text>
        </Node>

        <!-- Berserk mode (50% HP) -->
        <Node NodeId="berserk_mode">
            <Text>ENOUGH! You think you've won?!</Text>
            <Text>I'm just getting started!</Text>
            <Action Type="AssignTrait" Trait="Aggression" TraitValue="100" />
            <Action Type="ChangeStance" RefName="Offensive" />
            <Action Type="ChangeAffinity" RefName="Fire" />
            <Action Type="CastSpell" RefName="Fireball" />
        </Node>

        <!-- Tactical retreat (30% HP) -->
        <Node NodeId="retreat_defensive">
            <Text>Perhaps I underestimated you...</Text>
            <Text>But a true warrior knows when to defend!</Text>
            <Action Type="ChangeStance" RefName="Defensive" />
            <Action Type="HealSelf" Amount="15" />  <!-- Heal 15% -->
        </Node>

        <!-- Last stand (15% HP) - player choice! -->
        <Node NodeId="last_stand">
            <Text>This... this cannot be!</Text>
            <Text>I am Lord Darkblade! I will not fall!</Text>
            <Choice Text="Let him surrender (end battle peacefully)" NextNodeId="accept_surrender" />
            <Choice Text="Finish him! (gain Ruthless trait)" NextNodeId="no_mercy" />
        </Node>

        <Node NodeId="accept_surrender">
            <Text>You... you spare me? I do not understand...</Text>
            <Text>Very well. You have proven yourself worthy. I yield.</Text>
            <Action Type="EndBattle" RefName="Victory" />
            <Action Type="AssignTrait" Trait="Merciful" TraitValue="1" />
            <Action Type="GiveEquipment" RefName="Greatsword" Amount="1" />  <!-- Boss gives his weapon -->
            <Action Type="TransferCurrency" Amount="500" />  <!-- And his gold -->
        </Node>

        <Node NodeId="no_mercy">
            <Text>So be it! If I fall, I fall with honor!</Text>
            <Text>But you'll remember this day, warrior!</Text>
            <Action Type="AssignTrait" Trait="Ruthless" TraitValue="1" />
            <Action Type="CastSpell" RefName="LastStandExplosion" />  <!-- Desperate spell -->
            <!-- Battle continues - boss makes one last attack -->
        </Node>

        <!-- Mock player when they're low HP -->
        <Node NodeId="mock_player">
            <Text>Growing tired, are we? Soon you'll be BEGGING for mercy!</Text>
            <Action Type="ChangeStance" RefName="Offensive" />
        </Node>

        <!-- On Defeat (if boss is defeated) -->
        <Node NodeId="defeated">
            <Text>I... I have been defeated...</Text>
            <Text>Perhaps... you were the true warrior all along...</Text>
            <!-- Player can choose to loot or spare -->
        </Node>

    </DialogueTree>

</DialogueTrees>
